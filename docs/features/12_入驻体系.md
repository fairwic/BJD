# 12 入驻体系

## 概述
入驻体系支持用户申请成为平台商家、团长、妆师/毛娘，是平台创作者经济的入口。

**优先级**：P0 (Core/MVP)

**包含页面**：
- `MerchantApply.jsx` - 商家入驻申请
- `LeaderApply.jsx` - 团长入驻申请
- `ArtistApply.jsx` - 妆师/毛娘入驻申请

---

## 1. 商家入驻 (`MerchantApply.jsx`)

### 1.1 功能定位
用户申请成为现货商家，通过审核后可发布现货商品。

### 1.2 页面结构
```
┌─────────────────────────────┐
│ [<]        成为商家          │
├─────────────────────────────┤
│  [橙色Banner]               │
│  成为BJD现货商家              │
│  将您的BJD好物分享给更多娃友   │
│  ┌───────────────────────┐  │
│  │ 5000+ | 10万+ |  0    │  │
│  │活跃商家 月成交 入驻费用 │  │
│  └───────────────────────┘  │
├─────────────────────────────┤
│  入驻权益                    │
│  ├ 开设专属店铺              │
│  ├ 发布现货商品              │
│  ├ 便捷发货                  │
│  └ 交易保障                  │
├─────────────────────────────┤
│  入驻条件                    │
│  ✓ 完成实名认证              │
│  ✓ 提供有效联系方式          │
│  ✓ 同意《商家入驻协议》      │
├─────────────────────────────┤
│  [立即入驻] 按钮             │
└─────────────────────────────┘
```

### 1.3 申请流程

| 步骤 | 页面 | 用户操作 | 系统响应 |
|------|------|----------|----------|
| 1 | 介绍页 | 查看权益和条件 | 展示入驻说明 |
| 2 | 介绍页 | 点击「立即入驻」 | 切换到表单页 |
| 3 | 表单页 | 填写店铺名称 | 实时校验(2-20字) |
| 4 | 表单页 | 选择经营类目 | 单选高亮 |
| 5 | 表单页 | 填写联系方式 | 手机号+微信号 |
| 6 | 表单页 | 上传资质 | 身份证(必填)+营业执照(选填) |
| 7 | 表单页 | 勾选协议 | 必须勾选才能提交 |
| 8 | 表单页 | 点击「提交申请」 | 校验 -> 提交API |
| 9 | 成功页 | 查看结果 | 显示"1-3个工作日审核" |

### 1.4 表单字段

| 字段 | 类型 | 必填 | 校验规则 |
|------|------|------|----------|
| 店铺名称 | 文本 | ✓ | 2-20字 |
| 经营类目 | 单选 | ✓ | 娃衣/眼珠/整娃/拍摄道具/其他 |
| 店铺简介 | 文本 | ✗ | 最多200字 |
| 手机号 | 文本 | ✓ | 11位手机号 |
| 微信号 | 文本 | ✗ | 最多50字 |
| 身份证照片 | 图片 | ✓ | ≤5MB |
| 营业执照 | 图片 | ✗ | ≤5MB |

---

## 2. 团长入驻 (`LeaderApply.jsx`)

### 2.1 功能定位
用户申请成为团长，通过审核后可发起团购活动。

### 2.2 页面结构
```
┌─────────────────────────────┐
│ [<]        成为团长          │
├─────────────────────────────┤
│  [紫色Banner]               │
│  成为BJD团长                 │
│  开启您的团购事业             │
│  ┌───────────────────────┐  │
│  │ 2000+| ¥50万+| 3.5%   │  │
│  │活跃团长 月交易额 佣金比例│  │
│  └───────────────────────┘  │
├─────────────────────────────┤
│  团长权益                    │
│  ├ 官方认证团长徽章          │
│  ├ 发起团购活动              │
│  ├ 佣金收益                  │
│  └ 平台保障                  │
├─────────────────────────────┤
│  入驻条件                    │
│  ✓ 完成实名认证              │
│  ✓ 有BJD圈子相关经验         │
│  ✓ 提供过往团购记录          │
│  ✓ 同意《团长服务协议》      │
├─────────────────────────────┤
│  [申请成为团长] 按钮         │
└─────────────────────────────┘
```

### 2.3 表单字段

| 字段 | 类型 | 必填 | 校验规则 |
|------|------|------|----------|
| 团长昵称 | 文本 | ✓ | 2-20字 |
| 擅长领域 | 单选 | ✓ | 三分娃/四分娃/六分娃/大娃/娃衣/眼珠假毛/其他 |
| 相关经验 | 文本 | ✓ | 10-500字 |
| 手机号 | 文本 | ✓ | 11位 |
| 微信号 | 文本 | ✓ | 必填 |
| 淘宝店铺链接 | URL | ✗ | 可选 |
| 身份证照片 | 图片 | ✓ | ≤5MB |
| 历史开团截图 | 图片 | ✗ | ≤5MB，最多3张 |

---

## 3. 妆师/毛娘入驻 (`ArtistApply.jsx`)

### 3.1 功能定位
用户申请成为妆师或毛娘，通过审核后可在平台接单提供服务。

### 3.2 页面结构
```
┌─────────────────────────────┐
│ [<]     成为妆师/毛娘        │
├─────────────────────────────┤
│  [玫瑰色Banner]             │
│  成为BJD大师                 │
│  用您的技艺为娃娃注入灵魂     │
│  ┌───────────────────────┐  │
│  │ 500+ | ¥800+ | 98%   │  │
│  │认证大师 平均单价 好评率 │  │
│  └───────────────────────┘  │
├─────────────────────────────┤
│  大师权益                    │
│  ├ 官方认证大师标识          │
│  ├ 接单赚收益                │
│  ├ 展示作品集                │
│  └ 大师社区                  │
├─────────────────────────────┤
│  入驻条件                    │
│  ✓ 完成实名认证              │
│  ✓ 提供至少3张作品照片       │
│  ✓ 有一定的服务经验          │
│  ✓ 同意《大师服务协议》      │
├─────────────────────────────┤
│  [申请成为大师] 按钮         │
└─────────────────────────────┘
```

### 3.3 类型选择

| 类型 | 描述 | 风格选项 |
|------|------|----------|
| 妆师 | 娃娃妆面绘制 | 古风/清冷/日系/病娇/甜美/暗黑/写实/其他 |
| 毛娘 | 假发/植毛制作 | 长直/卷发/古风/现代/染色/植毛/造型/其他 |

### 3.4 表单字段

| 字段 | 类型 | 必填 | 校验规则 |
|------|------|------|----------|
| 大师类型 | 单选 | ✓ | 妆师/毛娘 |
| 大师名称 | 文本 | ✓ | 2-20字 |
| 擅长风格 | 多选 | ✓ | 至少选1个 |
| 个人简介 | 文本 | ✗ | 最多500字 |
| 手机号 | 文本 | ✓ | 11位 |
| 微信号 | 文本 | ✓ | 必填 |
| 作品照片 | 图片 | ✓ | 至少3张，每张≤5MB |
| 资质证书 | 图片 | ✗ | ≤5MB |

---

## 入口位置

入驻入口位于「我的」页面，显示为"开启创作者之旅"卡片区域：

```
┌─────────────────────────────┐
│  开启创作者之旅              │
│  轻松入驻 · 开始赚钱          │
├─────────────────────────────┤
│  ┌─────┐ ┌─────┐ ┌─────┐   │
│  │ 🛍️  │ │  ✨  │ │  🎨  │   │
│  │成为  │ │ 成为 │ │ 成为 │   │
│  │商家  │ │ 团长 │ │ 妆师 │   │
│  │卖现货│ │开团品│ │妆师   │   │
│  └─────┘ └─────┘ └─────┘   │
└─────────────────────────────┘
```

---

## 后端逻辑要点

### 数据模型

```sql
-- 入驻申请表
CREATE TABLE applications (
    id ULID PRIMARY KEY,
    user_id ULID NOT NULL,
    type VARCHAR(20) NOT NULL, -- merchant, leader, artist
    artist_type VARCHAR(20), -- makeup, wig (仅artist类型)
    name VARCHAR(50) NOT NULL,
    category VARCHAR(50),
    description TEXT,
    phone VARCHAR(20) NOT NULL,
    wechat VARCHAR(50),
    styles JSONB, -- 擅长风格数组
    id_card_image VARCHAR(500),
    license_image VARCHAR(500),
    portfolio_images JSONB, -- 作品/证书图片数组
    status VARCHAR(20) DEFAULT 'pending', -- pending, approved, rejected
    reject_reason VARCHAR(200),
    reviewed_at TIMESTAMPTZ,
    reviewed_by ULID,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 用户角色扩展
ALTER TABLE users ADD COLUMN roles JSONB DEFAULT '["buyer"]';
-- roles可包含: buyer, merchant, leader, artist
```

### API 设计

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/v1/applications` | POST | 提交入驻申请 |
| `/api/v1/applications` | GET | 查询我的申请列表 |
| `/api/v1/applications/{id}` | GET | 申请详情 |
| `/api/v1/admin/applications` | GET | 管理员查看待审核列表 |
| `/api/v1/admin/applications/{id}/approve` | POST | 审核通过 |
| `/api/v1/admin/applications/{id}/reject` | POST | 审核拒绝 |

### 注意事项

1. **重复申请**：
   - 同类型申请在审核中时不允许再次提交
   - 被拒绝后可修改后重新申请

2. **实名认证前置**：
   - 提交申请前检查 `is_verified` 状态
   - 未实名跳转到实名认证页面

3. **审核通过后**：
   - 更新 `users.roles` 数组添加对应角色
   - 发送审核通过通知
   - 团长需初始化信用分

4. **图片存储**：
   - 上传到OSS，存储URL
   - 身份证照片加密存储
