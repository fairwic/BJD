# 04 订单履约

## 概述
订单履约是交易闭环的核心，包含合同签署、订单状态管理、历史记录查询。

**优先级**：P0 (Core/MVP)

**包含页面**：
- `ContractSigning.jsx` - 签署购买协议
- `OrderDetail.jsx` - 订单详情
- `MyGroupBuys.jsx` - 我的参团记录
- `MyContracts.jsx` - 我的合同

---

## 1. 签署购买协议 (`ContractSigning.jsx`)

### 1.1 功能定位
支付定金前强制签署电子购买协议，具有法律效力。

### 1.2 用户操作流程

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 滚动阅读合同 | 必须滚动到底部才能勾选 |
| 2 | 勾选"我已阅读" | 「前往签名」按钮高亮 |
| 3 | 点击「前往签名」 | 进入横屏签名板(Canvas) |
| 4 | 手写签名 | 实时绘制笔迹，笔画>3有效 |
| 5 | 点击「确认使用」 | 签名合成到落款处 |
| 6 | 点击「签署并支付」 | 记录时间戳+IP -> 跳转支付 |

### 1.3 合同核心条款
- **定金约定**：定金支付后不可退还（红色加粗）
- **尾款时效**：通知后30天内补款
- **售后标准**：定制商品不支持七天无理由

---

## 2. 订单详情 (`OrderDetail.jsx`)

### 2.1 订单状态机
```
待付定金 -> 待审核 -> 制作中 -> 待付尾款 -> 待发货 -> 已发货 -> 已完成
```

### 2.2 各状态交互

| 状态 | 显示 | 可用操作 |
|------|------|----------|
| UNPAID_DEPOSIT | 倒计时15分钟 | 「支付定金」 |
| PRODUCTION | TrustTimeline | 「生成转单码」 |
| WAIT_FINAL | 待付尾款 | 「支付尾款」 |
| SHIPPED | 已发货 | 「查看物流」「确认收货」 |

### 2.3 转单功能
点击「生成转单码」-> 确认 -> 生成8位大写码 -> 可复制/保存海报

---

## 3. 我的参团记录 (`MyGroupBuys.jsx`)

Tab筛选：全部 / 进行中 / 已完成

点击订单卡片 -> 跳转OrderDetail

---

## 4. 我的合同 (`MyContracts.jsx`)

列表展示已签合同，支持查看PDF和下载。
