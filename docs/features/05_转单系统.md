# 05 转单系统

## 概述
转单是平台核心创新功能，允许用户将"制作中"的订单转让给他人，回收定金。

**优先级**：P0 (Core/MVP)

**包含页面**：
- `TransferLanding.jsx` - 转单落地页(接收端)

---

## 1. 转单落地页 (`TransferLanding.jsx`)

### 1.1 功能定位
买家通过输入转单码或扫码接收他人转让的订单。

### 1.2 页面结构
```
┌─────────────────────────────┐
│ [<]         接收转单         │
├─────────────────────────────┤
│  [图标] 输入转单码接单        │
├─────────────────────────────┤
│  ┌─────────────────────┐    │
│  │ A B C D 1 2 3 4     │    │
│  └─────────────────────┘    │
├─────────────────────────────┤
│  [确认接单]                  │
└─────────────────────────────┘
```

### 1.3 用户操作流程

| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 输入8位转单码 | 实时自动转大写格式化 |
| 2 | 点击「确认接单」 | 调用API查询订单信息 |
| 3 | 查看订单摘要 | 展示商品图+标题+转让价格 |
| 4 | 点击「立即接单」 | 进入支付流程(支付金额=原定金) |
| 5 | 支付成功 | 原子交易完成 -> 订单归属变更 -> 跳转成功页 |

### 1.4 异常处理

| 异常 | 系统响应 |
|------|----------|
| 码已使用 | Toast"该转单码已失效" |
| 码过期(7天) | Toast"转单码已过期" |
| 已被他人接单 | Toast"手慢了，该订单已被截胡" |

### 1.5 业务规则

| 规则项 | 说明 |
|--------|------|
| 原子性交易 | 扣款+打款+移交必须在一个事务中 |
| 锁单机制 | 进入确认页时加5分钟互斥锁 |
| 地址重置 | 订单转移后收货地址置空，需重新选择 |
| 每日限额 | 每用户每日限转出/入各3单 |
