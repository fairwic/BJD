# BJD 团购平台（拼团大师）产品功能文档

## 📋 文档信息
- **项目名称**：GOMaster / 拼团大师
- **版本号**：v1.0.0
- **最后更新**：2024-12-08
- **文档类型**：产品需求规格说明书（PRD）

---

## 一、项目概述

### 1.1 产品定位
拼团大师是一个专注于BJD（球形关节人偶）领域的团购社交平台，解决BJD玩家在团购过程中的信任问题、订单管理难题以及转单痛点。

### 1.2 核心用户
- **普通用户（买家）**：BJD爱好者，希望以优惠价格购买娃娃及周边
- **团长（组织者）**：经验丰富的BJD玩家，组织团购赚取差价
- **商家（卖家）**：娃社、手作店铺，销售现货商品

### 1.3 核心价值
- 🛡️ **信任体系**：实名认证、电子合同、信用评分
- 📊 **高效管理**：Excel导入订单、自动化进度通知、一键导出发货单
- 🔄 **转单创新**：无需团长干预，用户间直接转让订单
- 💬 **社群生态**：晒图广场、私养相册、团长评价

---

## 二、功能模块详细说明

### 模块 1：用户认证与账号管理

#### 1.1 登录注册
**页面**：`Login.jsx`

**UI设计亮点**：
- **Glassmorphism 毛玻璃风格**：半透明白色卡片 + 背景模糊效果
- **BJD主题背景**：使用娃娃摄影图作为背景，叠加渐变蒙层
- **动画blob装饰**：玫瑰色/紫色/蓝色floating气泡动效
- **平滑Tab切换**：验证码/密码登录Tab带过渡动画

**  功能描述**：
1. **双模式登录**：
   - **验证码登录**（默认）：手机号 + 短信验证码
   - **密码登录**：手机号 + 密码 + "忘记密码"链接

2. **第三方登录**：
   - 微信登录（绿色图标）
   - QQ登录（蓝色图标）
   - 圆形按钮 + hover放大效果

3. **协议勾选**：
   - 强制勾选《用户服务协议》和《隐私政策》
   - 使用玫瑰色选中态，未勾选时无法登录

**交互流程**：
```
输入手机号 → 切换登录方式(验证码/密码) → 
  [验证码] 点击"获取验证码" → 输入6位验证码
  [密码] 输入密码 → 可点击"忘记密码？"
→ 勾选协议 → 点击"立即登录" → 跳转首页
```

**业务规则**：
- 验证码60秒内不可重复获取（前端倒计时）
- 密码需≥6位
- 必须勾选协议否则按钮禁用
- 首次登录自动注册

---

#### 1.2 忘记密码
**页面**：`ForgotPassword.jsx`

**功能描述**：
- 手机号验证码重置密码
- 新密码强度校验

**交互流程**：
```
输入手机号 → 获取验证码 → 输入新密码 → 确认密码 → 重置成功 → 返回登录
```

---

#### 1.3 个人资料编辑
**页面**：`ProfileEdit.jsx`

**功能描述**：
- 修改头像（本地上传）
- 编辑用户名、昵称、个性签名
- 绑定/修改手机号、邮箱
- 编辑收货地址

**数据字段**：
```
- 头像 (avatar) - 图片URL
- 用户名 (name) - 必填，3-20字符
- 昵称 (nickname) - 可选
- 个性签名 (bio) - 可选，最多100字
- 手机号 (phone) - 必填
- 邮箱 (email) - 可选
```

---

#### 1.4 账号安全
**页面**：`AccountSecurity.jsx`

**功能描述**：
- 修改登录密码
- 绑定/更换手机号
- 绑定/更换邮箱
- 登录设备管理
- 安全等级评估

**安全等级规则**：
- 低（红）：仅密码登录
- 中（橙）：密码 + 手机号
- 高（绿）：密码 + 手机号 + 邮箱 + 实名认证

---


---


---

#### 1.4 账号安全
**页面**：`AccountSecurity.jsx`

**功能描述**：
用户安全中心，直观展示账号安全等级。

**核心功能**：
- **安全等级可视化**：红/橙/绿 三色进度条展示当前安全指数
- **修改密码**：验证旧密码 -> 输入新密码 (6位以上) -> 二次确认
- **绑定管理**：手机号、邮箱绑定状态查看与变更
- **登录记录**：查看历史登录设备 (Mock)

---

#### 1.5 实名认证
**页面**：`RealNameVerification.jsx`

**功能描述**：
实名认证是保障交易安全的基础，未认证用户无法发起团购。

**页面元素**：
- **基本信息表单**：真实姓名 (必填)、身份证号 (18位校验)、手机号 (11位校验)
- **证件上传**：身份证人像面、国徽面 (支持 `image/*` 格式)
- **提示信息**：顶部蓝框提示认证必要性

**交互流程**：
1. 填写姓名、身份证号、手机号
2. 点击上传正反面照片 (支持预览)
3. 点击“提交认证”
4. 系统校验必填项 -> 模拟提交 (2秒loading) -> 返回上一页

**业务规则**：
- 身份证号必须为18位
- 手机号必须为11位
- 必须上传双面照片才可提交
- 提交后状态扭转为“审核中” (Mock: 1-3工作日)

---

#### 1.6 支付设置
**页面**：`PaymentSettings.jsx`

**功能描述**：
管理原本用于支付定金和尾款的支付方式。

**支持类型**：
- 支付宝 (Alipay)
- 微信支付 (WeChat)
- 银行卡 (Bank Card)

**交互逻辑**：
- **列表展示**：卡片式设计，显示账号掩码 (如 `138****8888`)
- **添加/删除**：支持添加新卡 (Mock)，侧滑或点击垃圾桶删除
- **默认设置**：可将任一方式“设为默认”

---

#### 1.7 收货地址管理
**页面**：`AddressManagement.jsx`

**功能描述**：
- 新增收货地址
- 编辑已有地址
- 删除地址
- 设置默认地址

**数据字段**：
```
- 收件人 (name)
- 手机号 (phone)
- 地址 (address) - 省市区 + 详细地址
- 是否默认 (isDefault)
```

---

### 模块 2：商品浏览与团购

#### 2.1 首页 - 双Tab模式
**页面**：`App.jsx - UserShop`

**功能描述**：

**Tab 1：现货市集**
- 商家发布的现货商品
- 按品牌风格分类（日韩系、国产系）
- 按尺寸筛选（叔、三分、四分、六分...）
- 按类型筛选（整娃、素体、娃衣、假发、眼珠...）

**Tab 2：开团广场**
- 团长发布的团购活动
- 图文卡片展示
- 显示团购进度、截团时间
- 互动数据（点赞、评论）

**交互设计**：
```
顶部双Tab切换 + 搜索按钮
↓
[现货市集] 品牌筛选栏 + 尺寸/类型筛选栏 + 商品网格
[开团广场] 团购卡片流 + 快速参团按钮
```

---

#### 2.2 商品详情
**页面**：`ProductDetail.jsx`

**页面结构**：
1. **顶部导航栏**（毛玻璃悬浮）
   - 返回按钮
   - 分享按钮
   - 收藏按钮（空心❤️ / 实心❤️）

2. **商品主图**
   - 正方形占位图（`aspect-square`）
   - 右下角状态标签："征集中" / "制作中" / "现货" 等

3. **价格与标题**
   - **团购**: 显示 "定金 ¥XXX"（小字灰色）
   - **现货**: 显示 "现货速发"（小字灰色）
   - 大标题 + 全款价格（玫瑰红、粗体、2xl）

4. **团长信息卡片** (可点击跳转)
   - 头像 + 昵称
   - 信用评分 + 粉丝数（"信用极好 · 1250 粉丝"）
   - "进店逛逛"按钮（玫瑰色边框）

5. **🎮 游戏化：阶梯解锁奖励** (仅团购显示)
   - **背景**：深紫色渐变 + 奖杯水印
   - **进度条**：
     - 当前团购份数 / 目标份数（如 382/500）
     - 解锁进度百分比（76%）
   - **里程碑**：
     - 100单：成团 ✅ (已解锁)
     - 300单：特典眼珠 ✅ (已解锁)
     - 500单：特殊肤色 🔒 (未解锁)
   - **下一阶段提示**："还差 118 单解锁，快邀请好友吧！"
   - **邀请按钮**：黄色CTA按钮

6. **商品详情**
   - 灰底圆角卡片
   - 商品描述文本（可折叠）

7. **SKU 规格选择**
   - 按钮组（肤色/尺寸/定制选项）
   - 选中态：玫瑰色边框 + 玫瑰色背景
   - 未选中态：灰色边框 + 白色背景

8. **信任徽章**（3列网格）
   - ✅ 实名认证（绿色盾牌）
   - ⏰ 工期保障 / 极速发货（蓝色时钟）
   - 🛍️ 售后无忧（紫色购物袋）

9. **底部操作栏**（固定底部）
   - 店铺图标（灰色）
   - 主CTA按钮：
     - 未选择SKU: "请选择规格"（灰色禁用）
     - 已选择SKU (团购): "支付定金 ¥XXX"（黑色按钮）
     - 已选择SKU (现货): "立即购买 ¥XXX"（黑色按钮）

**交互流程**：
```
浏览商品图 → 查看解锁进度 → 点击团长卡片(可选) → 
选择SKU规格 → 点击"支付定金 ¥XXX" → 跳转合同签署页
```

**关键逻辑**：
- 根据 `product.type` 区分团购/现货
- SKU必选，否则CTA按钮禁用
- 团购商品才显示"阶梯解锁奖励"模块

---

#### 2.3 团长主页
**页面**：`LeaderProfile.jsx`

**功能描述**：
- 团长头像、昵称、认证标识
- 粉丝数、开团数、信用评分
- 个人简介
- 进行中的团购列表
- 历史团购
- 用户评价

**交互**：
- 点击"关注"按钮
- 查看团购详情
- 跳转商品详情页

---

#### 2.4 商家主页
**页面**：`MerchantProfile.jsx`

**功能描述**：
- 店铺封面、头像
- 金牌商家标识
- 店铺评分、销量、所在地
- 店内商品搜索
- 商品网格展示

**交互**：
- 收藏店铺
- 搜索店内商品
- 进入商品详情

---

### 模块 3：订单管理（用户端）

#### 3.1 订单详情
**页面**：`OrderDetail.jsx`

**功能定位**：
用户管理单个订单的**全生命周期页面**，包含状态可视化、支付操作、转单功能。

**📊 订单状态机** (7种状态):
```
1. UNPAID_DEPOSIT (待付定金)
   ↓ [用户支付定金]
2. WAIT_VERIFY (待审核)
   ↓ [团长确认收款]
3. PRODUCTION (制作中) ← 可生成转单码
   ↓ [工厂完工,触发尾款通知]
4. WAIT_FINAL (待付尾款)
   ↓ [用户支付尾款]
5. WAIT_SHIP (待发货)
   ↓ [团长填写运单号]
6. SHIPPED (已发货)
   ↓ [用户确认收货]
7. COMPLETED (已完成)
```

**页面结构**：

1. **状态卡片** (白色圆角卡片)
   - **状态图标** (10×10圆形): 制作中=🕒Clock / 其他=✅CheckCircle
   - **状态标题** (动态渲染8种文案)
   - **预计发货**: "预计发货: 2024年5月"

2. **🔐 生产全链路监控** (TrustTimeline组件)
   ```
   [●───────●───────●───────○───────○───────○]
   原型制作  翻模   树脂灌注  打磨   上妆    发货
   10/05   11/12   12/01
   📷📷    📷
   ```
   - **已完成阶段**: ✅ 绿色实心圆 + 日期 + 工厂照片
   - **当前阶段**: 🔵 蓝色脉冲圆 + 进度条动画
   - **未开始**: ⚪ 灰色空心圆

3. **商品卡片**: 缩略图 + 标题 + 规格 + 价格 + 数量

4. **💰 支付信息卡片**: 定金/尾款/实付金额明细

5. **🔄 一键转单模块** (仅 `PRODUCTION` 状态显示)
   - 渐变背景 (紫→玫瑰)
   - 未生成时: [生成转单码] 按钮
   - 已生成: 显示转单码 `TRANS-o1-A8F4E` + 复制按钮
   - 点击复制 → `navigator.clipboard.writeText()`

6. **底部操作栏** (固定底部, 条件渲染)
   | 订单状态 | 按钮展示 |
   |---|---|
   | `UNPAID_DEPOSIT` | `[支付定金 ¥500]` 玫瑰红CTA |
   | `WAIT_VERIFY` | `[等待审核中...]` 灰色禁用 |
   | `WAIT_FINAL` | `[支付尾款 ¥2500]` 玫瑰红CTA |
   | 其他 | 无按钮 |

---


---

#### 3.2 转单功能（核心创新）
**页面**：`OrderDetail.jsx` (生成端) + `TransferLanding.jsx` (接收端)

**业务流程**：
```
卖家（用户A）
↓
1. 在订单详情页点击"生成转单码" (仅制作中状态可用)
↓
2. 系统生成唯一码：TRANS-o1-ABCDE
↓
3. 分享转单码给买家（用户B）

买家（用户B）
↓
1. 打开“接收转单”页面
↓
2. 输入转单码 (支持大写自动格式化)
↓
3. 点击“确认接收” -> 系统校验有效性
↓
4. 校验通过 -> 订单所有权转移
↓
5. 跳转至首页，可见新订单
```

**接收端页面 (`TransferLanding.jsx`) 特性**：
- **大图引导**：顶部图标引导，清晰明了
- **输入框**：大号字体，专为输入短码优化
- **反馈**：成功/失败会有明显的颜色提示框 (绿/红)

**核心价值**：
- ✅ 用户A回血，无需损失定金
- ✅ 团长无需手动改Excel
- ✅ 自动更新收货地址
- ✅ 保障交易安全

---

#### 3.3 我的参团记录
**页面**：`MyGroupBuys.jsx`

**功能描述**：
- 全部订单列表
- 进行中订单
- 已完成订单
- 每个订单显示：商品图、标题、规格、状态、进度条

**筛选Tab**：
- 全部
- 进行中（待补款、制作中）
- 已完成（已发货、已完成）

---

#### 3.4 我的合同
**页面**：`MyContracts.jsx`

**功能描述**：
- 显示所有已签署的电子合同
- 合同编号：CT-{订单号}
- 合同状态：已签署
- 下载/查看合同PDF

**数据字段**：
```
- 合同编号 (contractId)
- 订单号 (orderId)
- 商品名称 (title)
- 签署时间 (signedAt)
- 合同状态 (status)
```

---

### 模块 4：团长工作台


---

#### 4.1 发起团购
**页面**：`CreateGroupBuy.jsx`

**功能描述**：
团长发布新团购的入口，支持Excel批量导入规格。

**表单字段**：
- **基本信息**：标题(必填)、全款金额(必填)、定金金额(必填)、截团时间、详细描述
- **规格列表**：可手动添加默认为“默认规格”，或通过Excel导入

**Excel导入功能 (核心)**：
- **支持格式**：`.xlsx` 或 `.xls`
- **解析逻辑**：使用 `xlsx` 库前端解析
- **表头识别**：自动识别 `规格名称`/`name` 和 `价格`/`price` 列
- **预览**：导入后立即在下方显示解析出的规格列表 (名称 + 价格)
- **校验**：若表格为空或格式错误，显示红色错误提示

**交互**：
- 点击/拖拽上传区域 -> 选择文件 -> 自动解析 -> 显示“成功导入 N 个规格” -> 点击发布

---

#### 4.2 我的团购列表
**页面**：`GroupBuyManagement.jsx`

**功能描述**：
- 显示当前团长发布的所有团购
- 每个团购显示：
  - 商品图、标题、状态
  - 进度条（0-100%）
  - 订单数、总营收、待发货数
- 点击进入团购详情

**快捷操作**：
- "开团"按钮（跳转创建团购页）

---

#### 4.3 团购详情页
**页面**：`GroupBuyDetail.jsx`

**功能定位**：
团长查看单个团购**全局数据**和**管理生产进度**的专用页面。

**页面结构**：

1. **团购信息卡片**
   - 商品缩略图 (24×24 圆角)
   - 团购标题 + 状态标签 (征集中/制作中/已完成)
   - 当前进度百分比 (如 45%)
   - 开团时间

2. **📊 核心数据看板** (2×2网格)
   ```
   ┌─────────────┬─────────────┐
   │ 👥 总订单   │ 💰 总营收   │
   │    25单     │   ¥75,000   │
   ├─────────────┼─────────────┤
   │⚠️待审核定金 │⚠️待补尾款   │
   │    3单      │    8单      │
   └─────────────┴─────────────┘
   ```

3. **🔄 生产进度监控** (TrustTimeline组件)
   可视化时间线展示6个生产阶段：
   ```
   1. 原型制作 ✅ (2023-10-01, 含照片)
   2. 翻模       ✅ (2023-11-15, 含照片)
   3. 树脂灌注   🔵 (当前阶段, 2023-12-01)
   4. 打磨       ⚪ (未开始)
   5. 上妆       ⚪ (未开始)
   6. 发货       ⚪ (未开始)
   ```
   - **已完成阶段**: 绿色✅ + 日期 + 工厂照片
   - **当前阶段**: 蓝色圆点 + 进度条
   - **未开始**: 灰色圆圈

4. **📦 SKU规格统计**
   ```
   白肌     12单
   普肌      8单
   烧肌      5单
   ```

5. **🎛️ 进度管理控制面板** (4个按钮)
   - [截团并制作 (30%)] - 灰色边框
   - [更新进度 (80%)]   - 灰色边框
   - [完工/收尾款 (100%)] - 蓝色 (**触发尾款通知**)
   - [全部完成]          - 绿色

**触发逻辑** (点击"完工/收尾款"):
```
1. 团购进度更新为100%
   ↓
2. 所有关联订单状态：制作中 → 待补款
   ↓
3. 系统发送微信服务通知/短信给所有买家
   ↓
4. 买家收到补款提醒
```

---


---

#### 4.4 订单管理台
**页面**：`OrderManagement.jsx`

**功能描述**：
团长的一站式工作台，集中处理所有订单状态。

**数据看板 (Dashboard)**：
- **快捷入口**：[我的团购] (跳转列表)、[待发货订单] (跳转发货管理)
- **核心指标**：待审核数 (红)、制作中数 (蓝)、总营收 (黑)

**任务列表**：
1.  **待审核定金**：
    - 展示：商品名、用户ID、规格、已付定金金额
    - 操作：[确认收款] -> 状态变更为 `PRODUCTION`

2.  **待发货**：
    - 展示：商品名、用户ID、尾款支付状态
    - 操作：[发货] -> 状态变更为 `SHIPPED`

**进度演示功能 (Mock)**：
- 提供 [更新进度 50%] 和 [完工 (触发尾款)] 按钮，用于演示状态流转和通知触发逻辑。

**导出功能**：
- 按钮：顶部导航栏 [导出]
- 格式：`.xlsx`
- 包含字段：订单号, 商品, 规格, 买家ID, 状态, 已付定金, 已付尾款, 下单时间
- 实现：前端直接生成并下载，无需后端生成

---

#### 4.5 发货管理
**页面**：`ShippingManagement.jsx`

**功能描述**：

**Tab切换**：
- 待发货（显示数量）
- 已发货

**待发货列表**：
- 订单号、商品、规格
- 收件人、手机号、收货地址
- "复制地址"按钮
- "立即发货"按钮

**发货操作**：
```
点击"立即发货" → 弹窗输入运单号 → 确认 → 订单状态更新 → 自动通知买家
```

**搜索功能**：
- 支持按订单号、收件人、手机号搜索

---

### 模块 5：社交广场

#### 5.1 广场首页
**页面**：`App.jsx - Square`

**功能描述**：
- 信息流展示用户发布的动态
- 搜索框（搜索动态内容）
- "+"按钮（发布动态）
- AI文案助手引导卡片

**动态卡片**：
- 用户头像、昵称、认证标识、标签（资深玩家、手作娘）
- 发布时间、距离
- 文字内容
- 图片（最多9张）
- 互动按钮：点赞、评论、分享
- 点击卡片进入动态详情

---


---

#### 5.2 发布动态
**页面**：`CreatePost.jsx`

**功能描述**：
用户分享娃圈日常的入口。

**页面元素**：
- **多媒体**：图片九宫格 (支持预览、删除)，由 `input type="file" multiple` 实现
- **文本**：多行文本框，支持 Emoji
- **标签**：独立输入框，支持话题 (如 #BJD)
- **AI 助手**：(Mock) 文案灵感助手入口，提示“让 AI 帮你写出神仙文案”

**交互**：
- 图片上传后自动在网格中显示
- 点击右上角 [发布] -> 校验内容非空 -> 提示成功 -> 返回上一页

#### 5.3 动态详情
**页面**：`PostDetail.jsx`

**功能描述**：
社交互动的核心页面。

**核心展示**：
- **用户信息**：头像(带V认证标识)、昵称、距离(LBS)、发布时间
- **内容区**：文本自动换行、图片网格 (1-9张自适应)
- **互动栏**：
  - ❤️ 点赞：实时切换红心状态及数字加减
  - 💬 评论：底部固定输入框，发送后立即追加到列表
  - 🔗 分享：调用系统分享 (Mock: alert提示)

**评论系统**：
- 列表展示头像、昵称、内容、时间、点赞数
- 底部输入框悬浮，支持快速发送

---

#### 5.4 用户主页
**页面**：`PublicUserProfile.jsx`

**功能定位**：
查看其他用户的公开信息、动态和数据统计。

**页面结构**：

1. **用户信息卡片**
   - 头像 (20×20圆形, 边框阴影)
   - 用户名 + 简介 + 位置
   - 操作按钮: [关注] (玫瑰红) + [私信] (灰色边框)
   - 统计数据: 关注数/粉丝数/获赞数

2. **Tab切换** (动态/喜欢)
   - 选中态: `border-rose-500 text-gray-900`
   - 未选中: `border-transparent text-gray-400`

3. **内容列表**
   - **动态Tab**: 图片网格 + 内容摘要 + 点赞评论数
   - **喜欢Tab**: "用户设置了喜欢列表不可见"提示

**交互逻辑**：
- 点击头像 → 查看大图
- 点击关注 → 状态切换为"已关注"
- 点击私信 → 跳转私聊页面

---

#### 5.5 我的关注
**页面**：`MyFollowing.jsx`

**功能描述**：

**Tab切换**：
- 团长/店铺
- 用户

**列表显示**：
- 头像、昵称、简介
- 粉丝数
- "已关注"按钮
- 点击头像跳转主页

---

#### 5.6 我的喜欢
**页面**：`MyLikes.jsx`

**功能描述**：

**Tab切换**：
- 商品
- 动态

**商品列表**：
- 商品图、标题、价格、状态
- 红心标识
- 点击跳转商品详情

**动态列表**：
- 动态缩略图、文字摘要
- 用户昵称
- 点赞数
- 点击跳转动态详情

---

#### 5.7 我的相册
**页面**：`MyAlbum.jsx`

**功能描述**：
- 网格展示用户上传的所有图片
- 支持图片、视频
- 视频显示播放图标
- 点击查看大图/播放视频

---


---

### 模块 6：合同与法务

#### 6.1 签署购买协议
**页面**：`ContractSigning.jsx`

**功能描述**：
支付定金前的强制环节，通过模拟电子签名强化契约精神。

**合同核心条款 (显示在滚动框内)**：
1. **定金约定**：明确 **“定金支付后不可退还”** (红色加粗)，除非官方流团。
2. **尾款时效**：通知后30天内补款，逾期视为跑单。
3. **售后标准**：定制商品不支持七天无理由；严重质量问题24小时内联系。

**签署交互**：
1. **阅读**：必须勾选 [我已阅读并同意上述协议条款]
2. **签名**：点击 [点击此处签名] -> 转换为 [已签名] 状态 (显示手写体名字 + 绿色对钩)
3. **提交**：只有上述两步完成后，[签署并支付定金] 按钮才可点击
4. **后续**：模拟提交 -> 创建订单 -> 支付定金 -> 跳转订单详情

---

### 模块 7：消息与通知

#### 7.1 消息中心
**页面**：`App.jsx - Messages`

**功能描述**：

**Tab切换**：
- 聊天
- 通知（显示未读数）

**聊天列表**：
- 会话头像、名称
- 最后一条消息
- 时间
- 未读消息数

**通知列表**：
- 通知图标、标题、内容
- 时间
- 未读数

**通知类型筛选**：
- 评论和@
- 新增关注
- 收到的赞

**通知类型示例**：
- 新团开团通知
- 补款通知
- 参团成功通知
- 参团失败通知（流团）
- 发货通知
- 进度更新通知

---

### 模块 8：娃娃档案管理（P0 核心功能）

#### 8.1 我的娃娃列表
**页面**：`MyDolls.jsx`

**功能描述**：
- 展示用户拥有的所有娃娃卡片
- 快速查看：娃娃名称、照片、尺寸
- 支持搜索和筛选（按尺寸、品牌）
- "添加新娃娃"按钮

**卡片显示**：
```
┌─────────────┐
│  [娃娃照片]  │
│  小鹿        │
│  三分 | 白肌  │
│  已养182天   │
└─────────────┘
```

**交互**：
- 点击卡片 → 进入娃娃档案详情页
- 长按卡片 → 显示快捷菜单（编辑、删除、分享）

---


---

#### 8.2 娃娃档案详情
**页面**：`DollProfile.jsx`

**功能描述**：
娃娃的数字化身份证明和全生命周期管理。

**核心模块**：
1.  **基本信息卡片**：
    - 展示：名字、品牌、尺寸、肤色、生日
    - 统计：已养天数 (如 "已养54天 💖")

2.  **数据统计**：
    - 照片数、衣服数、保养记录数 (可视化图标展示)

3.  **关联信息 (跳转入口)**：
    - 🛍️ 购买订单 (关联 OrderID)
    - 📄 电子合同 (关联 ContractID)
    - 💄 妆面记录 (如 "原厂妆")

4.  **保养记录**：
    - 列表展示：日期、类型(维修/清洁)、备注
    - 示例："2023-12-01 维修 左手关节松动，已加紧"

5.  **电子身份证 (Share Feature)**：
    - 点击右上角分享图标触发
    - **UI效果**：拟物化证书设计 (BIRTH CERTIFICATE)，带花纹背景
    - **内容**：照片、姓名、品牌、生日、Guardian(当前用户)、ID Number
    - **交互**：支持保存图片、旋转照片动效

---

#### 8.3 添加娃娃
**页面**：`AddDoll.jsx`

**功能描述**：
- 手动添加：填写娃娃信息
- 从订单导入：选择已完成的订单，自动填充信息
- 上传照片（最多9张）
- 设置封面照片

**表单字段**：
- 娃娃名称（必填）
- 品牌/娃社
- 尺寸（下拉选择）
- 肤色
- 生日（开箱日期）
- 备注

---

### 模块 9：交易保障体系（P0 核心功能）

#### 9.1 订金托管机制

**业务流程**：
```
用户支付定金
    ↓
定金托管在平台（不直接给团长）
    ↓
团购成功（截团后）→ 自动结算给团长
团购失败（流团）→ 72小时内自动退回买家
超期未截团 → 自动触发退款
```

**显示标识**：
```
[资金安全保障]
✓ 定金由平台托管
✓ 流团自动退款
✓ 全程可追溯
```

**技术实现**：
- 订单表增加字段：`depositStatus` (托管中/已结算/已退款)
- 定时任务：检测截团时间，自动结算或退款
- 退款接口：调用支付平台原路退回

---

#### 9.2 团长保证金制度
**页面**：`DepositManagement.jsx`（团长专用）

**功能描述**：

**保证金规则**：
- 首次开团需缴纳保证金：5000元
- 信用分≥90：可降低至3000元
- 信用分≥95：可降低至2000元
- 保证金生息，年化3%
- 团长可随时提取利息

**保证金用途**：
- 买家跑单赔付
- 质量问题赔付
- 延期赔付（超过承诺工期30天以上）

**显示效果**：
```
[我的保证金]
当前保证金：¥5,000
累计收益：¥150
可提取收益：¥150

保障范围：
✓ 跑单赔付（最高1000元/单）
✓ 质量问题全额退款
✓ 延期补偿

[提取收益] [追加保证金]
```

**团长主页显示**：
```
[金牌团长] ✓
已缴纳5000元保证金
信用评分：95分
累计开团：25次
```

---

#### 9.3 开箱视频验货
**页面**：`UnboxingVideo.jsx`

**触发时机**：
- 订单状态变为"已发货"后
- 买家点击"确认收货"时

**功能描述**：

**录制流程**：
```
收到包裹
    ↓
打开App → 订单详情
    ↓
点击"录制开箱视频"
    ↓
相机自动开启（前置+后置切换）
    ↓
录制30-120秒视频
    ↓
自动上传到订单（加密存储）
    ↓
确认收货 or 申请售后
```

**强制提醒**：
```
⚠️ 重要提醒
为保障您的权益，请在拆箱前录制开箱视频

[立即录制] [稍后提醒]

*如发现质量问题，视频将作为维权凭证
```

**视频要求**：
- 时长：30-120秒
- 清晰展示：外包装、内部填充物、娃娃本体
- 重点拍摄：关节、妆面、瑕疵部位
- 自动添加水印：订单号、时间戳

**售后流程**：
```
发现质量问题
    ↓
点击"申请售后" → 选择问题类型
    ↓
上传视频证据（已录制的自动关联）
    ↓
平台客服审核（24小时内）
    ↓
审核通过 → 团长保证金赔付
审核不通过 → 买家申诉
```

---

### 模块 10：团长工具增强（P0 核心功能）

#### 10.1 自动催款系统

**业务规则**：
```
制作完成 → 通知补款
    ↓
第3天：首次提醒（微信服务号 + 短信）
第7天：二次提醒（增加App推送）
第15天：三次提醒（电话客服）
第25天：最后警告（标记"跑单预警"）
第30天：确认跑单 → 加入黑名单
```

**催款模板**：
```
[尾款催付提醒]
亲爱的{用户名}：

您参与的团购【{团购名称}】已制作完成！
请在{deadline}前补齐尾款，以便及时发货。

订单信息：
- 订单号：{orderId}
- 尾款金额：¥{finalPayment}
- 剩余时间：{remainDays}天

[立即支付]

*超期未付将影响您的信用评分
```

**团长视角**：
```
[催款进度]
待补款：15人
已催款3天：8人
已催款7天：5人
已催款15天：2人 ⚠️
已催款25天：0人
```

---

#### 10.2 黑名单共享机制

**触发条件**：
- 超30天未补尾款
- 恶意退单（连续3次）
- 收货后恶意差评

**黑名单效果**：
```
[风险用户警告]
⚠️ 该用户有跑单记录
用户ID：u123
跑单次数：1次
涉及金额：¥500
最近跑单：2023-11-01

建议操作：
□ 拒绝接单
□ 要求先全款
□ 正常接单（风险自负）
```

**买家限制**：
- 无法参与任何团购
- 无法发布动态
- 无法转单
- 账户显示"信用受限"

**解除条件**：
- 补齐欠款
- 提交申诉（平台客服审核）
- 等待3个月自动解除（仅限首次）

---

#### 10.3 进度通知自动化
**页面**：`ProgressNotificationManager.jsx`

**功能描述**：

**通知模板库**：
```
预设模板：
1. 截团通知
2. 开始制作
3. 进度更新（可自定义百分比）
4. 延期通知
5. 完工通知
6. 发货通知

自定义模板：
- 支持富文本编辑
- 插入变量：{用户名}、{团购名称}、{进度}
- 添加图片/视频
```

**发送方式**：
- 立即发送
- 定时发送（选择日期时间）
- 条件触发（进度达到XX%时自动发送）

**效果预览**：
```
[通知预览]
━━━━━━━━━━━━━━━
📢 进度更新

亲们好！工厂反馈本周开始打磨啦~
预计下周就能完工！

当前进度：80% ████████░░

请大家耐心等待哦 💖
━━━━━━━━━━━━━━━

发送对象：本团所有参与者（25人）
发送时间：立即发送
[确认发送]
```

**发送记录**：
- 显示历史通知
- 查看送达率、阅读率
- 用户反馈（点赞、评论）

---

#### 10.4 智能定价助手
**页面**：`PricingAssistant.jsx`

**功能描述**：

**输入参数**：
- 成本价（必填）
- 工期（月）
- 品牌/娃社
- 尺寸（三分/四分...）
- 类型（整娃/素体/娃衣...）

**AI分析**：
```
[定价建议报告]

你的成本：¥800
市场分析：
- 同类商品均价：¥1,450
- 价格区间：¥1,200 - ¥1,800
- 热门价格：¥1,500（占比35%）

推荐定价：
━━━━━━━━━━━━━━━━━━
保守定价：¥1,200
预计利润：¥400/单
成团概率：92%

合理定价：¥1,500 ⭐ 推荐
预计利润：¥700/单
成团概率：78%

高端定价：¥1,800
预计利润：¥1,000/单
成团概率：45%
━━━━━━━━━━━━━━━━━━

[采用推荐定价]
```

**历史数据**：
- 显示该团长历史定价
- 成交率统计
- 利润分析

---

### 模块 11：游戏化激励系统（P1）

#### 11.1 成就中心
**页面**：`AchievementCenter.jsx`

**功能定位**：
游戏化成就系统，激励用户参与平台活动。

**页面结构**：

1. **总体进度卡片** (渐变背景)
   - 解锁数统计: `2/8 已解锁成就`
   - 百分比圆圈: `25%`
   - 彩色进度条

2. **分类筛选**
   - `全部成就` | `新手成就` | `购物成就` | `社交成就`

3. **成就列表** (8个成就)

**成就稀有度系统**：
| 等级 | 名称 | 图标渐变色 |
|---|---|---|
| 1 | 普通 | `gray-400 → gray-600` |
| 2 | 稀有 | `blue-400 → blue-600` |
| 3 | 史诗 | `purple-400 → purple-600` |

**成就列表**：
- 🎉 **入坑徽章** (普通): 完成首次参团
- 📝 **实名玩家** (普通): 完成实名认证
- 🛍️ **剁手王** (稀有): 参与5次团购
- 💎 **壕无人性** (史诗): 累计消费10,000元
- 🔄 **转单达人** (稀有): 成功转让3次订单
- 📸 **晒图达人** (稀有): 发布10条动态
- ❤️ **人气王** (稀有): 获得100个赞
- 💬 **话痨** (稀有): 发表50条评论

**奖励类型**：
- 🏆 **虚拟徽章**: 个人主页展示
- 🎁 **优惠券**: 10-200元不等
- ⭐ **信用分**: +5~30分

**奖励说明卡片**：
- 虚拟徽章可在个人主页展示
- 优惠券可在购物时使用
- 信用分影响账号权益

---

#### 11.2 工期日历 & 倒计时
**集成到**：`OrderDetail.jsx`

**功能描述**：

**可视化日历**：
```
[工期进度日历]
━━━━━━━━━━━━━━━━━━━━━━━━━━
10月    11月    12月    1月    2月
━━━━━━━━━━━━━━━━━━━━━━━━━━
✓开团  ✓截团   ●制作   ○完工  ○发货
10/01  10/15   11/01   01/15  01/20
━━━━━━━━━━━━━━━━━━━━━━━━━━

当前阶段：制作中 (75%)
距离完工：45天
距离回家：50天 💖

[设置提醒]
```

**倒计时组件**：
```
┌─────────────────┐
│  ⏰ 距离回家      │
│  45天 12时 30分  │
│  ████████░░ 75% │
└─────────────────┘
```

**节点提醒**：
- 截团前3天：提醒尽快下单
- 制作进度更新：自动推送
- 完工提醒：准备补款
- 发货提醒：准备收货

---

### 模块 12：知识库与社区（P0）

#### 12.1 BJD知识库
**页面**：`KnowledgeBase.jsx`

**功能描述**：

**内容分类**：

**1. 新手指南**：
- BJD是什么？
- 如何选择第一只娃娃
- 尺寸对照表（叔/三分/四分...）
- 预算规划（1000/3000/5000+）

**2. 品牌大全**：
- 国产品牌：Ringdoll、DollZone、AS、GEM
- 日韩品牌：VOLKS、Fairyland、Luts
- 品牌对比：价格、质量、售后

**3. 术语解释**：
- 私养：用户自己拥有的娃娃
- 出生证：真品证明卡
- 工期：制作周期
- 素体/单头/整娃：商品类型
- 二样/三样：原型修改次数

**4. 避坑指南**：
- 如何识别假娃
- 警惕低价陷阱
- 团长选择技巧
- 付款安全须知

**5. 保养教程**：
- 关节松了怎么办
- 如何清洁娃娃
- 妆面保护方法
- 存放注意事项

**呈现形式**：
- 图文教程（Markdown）
- 视频教程（嵌入B站）
- 互动问答（社区UGC）
- 搜索功能

**UI设计**：
```
[知识库首页]
━━━━━━━━━━━━━━━━
🔍 搜索框

📚 热门教程
- 新手入坑指南 (12.5k阅读)
- 如何识别假娃 (8.3k阅读)

📖 分类浏览
[新手指南] [品牌大全] [术语解释]
[避坑指南] [保养教程]

💬 互动问答
- 三分和四分哪个更适合新手？
- 如何选择肤色？
━━━━━━━━━━━━━━━━
```


---

#### 12.2 肤色比对室 (Skin Match Studio)
**页面**：`SkinMatchStudio.jsx`

**功能描述**：
解决BJD玩家“配身”难题，提供可视化的肤色比对工具。

**核心功能**：
- **双栏选择**：
  - 左侧：选择本家/娃头（品牌+肤色）
  - 右侧：选择配身/娃体（品牌+肤色）
  - 支持品牌：Volks, Ringdoll, DollZone, Soom等

- **可视化比对**：
  - 屏幕左右分屏显示两种肤色
  - 中间接缝处模拟实物拼接效果，直观感受色差

- **智能分析报告**：
  - **匹配度打分**：0-100分
  - **评价标签**：完美契合、色差较小、色差明显
  - **专家建议**：例如“两者虽然都是白肌，但色调略有差异，建议参考买家返图”

**交互设计**：
```
[左侧选择]         [右侧选择]
Volks - 普白       Ringdoll - 白肌
   #fdf4f0           #fffbf0
      │                 │
      └──────┬──────────┘
             ▼
        [比对结果]
      色差较小 (85分)
  虽然都是白肌，但RD偏冷调
```

---

### 模块 13：每周活动（P2 增值功能）

#### 13.1 每周之星 / 娃娃选美
**页面**：`WeeklyContest.jsx`

**功能描述**：

**活动规则**：
- 每周一个主题（最美古风娃、最萌Q娃...）
- 用户上传参赛照片
- 投票周期：周一至周日
- 每人每天可投3票

**参赛流程**：
```
进入活动页
    ↓
点击"我要参赛"
    ↓
选择娃娃（从档案中）
    ↓
上传参赛照片（1-3张）
    ↓
填写作品说明
    ↓
提交审核（1小时内）
    ↓
审核通过 → 展示在活动页
```

**排行榜**：
```
[本周榜单]
━━━━━━━━━━━━━━━━
🥇 1. 小鹿 (1,250票)
   by @养娃大户
   [查看作品]

🥈 2. 小兔 (1,100票)
   by @手作娘小B

🥉 3. 小猫 (950票)
   by @摄影师C

━━━━━━━━━━━━━━━━
[查看更多]
```

**奖励**：
- 🥇 第一名：500元现金 + 首页推荐位7天
- 🥈 第二名：300元现金 + 首页推荐位3天
- 🥉 第三名：100元现金 + 虚拟徽章

**商业价值**：
- 团长可赞助活动（品牌曝光）
- 增加用户活跃度
- 持续产出优质内容

---

### 模块 14：许愿池与投票（P1 核心社群功能）

#### 14.1 许愿池
**页面**：`WishPool.jsx`

**功能描述**：
用户发布希望再贩（复刻）的绝版娃娃或期待的新品，通过投票聚集人气，促成官方或团长开团。

**核心机制**：
- **发布心愿**：用户提交心愿（如“Ringdoll 军阀 再贩”）
- **投票（点赞）**：普通用户每日可投一票
- **助燃（Boost）**：
  - 消耗金币购买“超级助燃”
  - 效果：热度+20 / 票数+50（效果翻倍）
  - 作用：快速提升心愿排名
- **状态流转**：
  - `投票中` (Voting)：等待积攒人气
  - `洽谈中` (Negotiating)：团长/商家已接单，正在联系官方
  - `开团成功` (Success)：已开启正式团购

**团长互动**：
- 团长看到热门心愿，可点击“**我有资源/已接单**”
- 心愿状态变更为“洽谈中”
- 系统通知所有投票用户：“您的心愿已被团长响应！”

**分享传播**：
- 生成“帮我投一票”卡片
- 专属口令 `#BJD心愿#12345`
- 复制口令打开App自动跳转

**UI展示**:
```
[许愿池 Top 3]
1. Volks 10周年复刻 🔥 9999+票
2. Ringdoll 军阀再贩 🔥 8848票
3. Soom 柴郡猫     🔥 5200票

[我的心愿]
我是发起人：3分 龙魂 汉风配件包
当前热度：40℃ (投票中)
[去拉票] [助燃]
```

---

## 三、角色权限矩阵

| 功能模块 | 普通用户 | 团长 | 商家 |
|---------|---------|------|------|
| 浏览商品/团购 | ✅ | ✅ | ✅ |
| 参与团购 | ✅ | ✅ | ❌ |
| 支付定金/尾款 | ✅ | ✅ | ❌ |
| 转单 | ✅ | ✅ | ❌ |
| 发起团购 | ❌ | ✅ | ❌ |
| 订单管理（审核/发货） | ❌ | ✅ | ✅ |
| 发布现货商品 | ❌ | ❌ | ✅ |
| 发布动态 | ✅ | ✅ | ✅ |
| 实名认证 | 可选 | **必须** | **必须** |
| 娃娃档案管理 | ✅ | ✅ | ❌ |
| 缴纳保证金 | ❌ | **必须** | ❌ |
| 开箱视频验货 | ✅ | ✅ | ❌ |
| 进度通知管理 | ❌ | ✅ | ❌ |
| 查看黑名单 | ❌ | ✅ | ❌ |
| 参与每周之星 | ✅ | ✅ | ✅ |

---

## 四、数据流与状态机

### 4.1 订单状态机

```
[待付定金] (UNPAID_DEPOSIT)
    ↓ 用户支付定金
[待审核] (WAIT_VERIFY)
    ↓ 团长确认收款
[制作中] (PRODUCTION)
    ↓ 工厂制作完成（团长触发）
[待付尾款] (WAIT_FINAL)
    ↓ 用户支付尾款
[待发货] (WAIT_SHIP)
    ↓ 团长发货
[已发货] (SHIPPED)
    ↓ 用户确认收货
[已完成] (COMPLETED)
```

**特殊状态**：
- [已转单] (TRANSFERRED) - 订单所有权已转移

---

### 4.2 团购进度状态

```
[征集中] - 0-50% - 收集定金阶段
[制作中] - 50-99% - 工厂生产阶段
[补款中] - 100% - 完工，等待买家补款
[发货中] - 100% - 陆续发货
[已结束] - 100% - 全部订单完成
```

---

## 五、关键业务规则

### 5.1 定金规则
- 定金一旦支付不可退款（除非流团）
- 流团条件：未达到起订量（由团长设定）
- 流团后定金全额原路退回

### 5.2 尾款规则
- 制作完成后30天内必须补款
- 超过30天未补款视为"跑单"
- 跑单用户：
  - 定金不退
  - 信用评分降低
  - 加入黑名单（无法参与其他团购）

### 5.3 转单规则
- 只有"制作中"状态的订单可转单
- 转单码有效期：7天
- 转单费用：新买家支付的金额 = 原定金金额
- 资金流向：新买家 → 原买家（非团长）
- 团长收到通知但无需手动操作

### 5.4 信用体系
**信用评分组成**：
- 是否实名认证：+10分
- 按时补款：+5分/次
- 跑单：-20分/次
- 收到好评：+2分/条

**信用等级**：
- 优秀（≥90分）：可享受先发货后补款
- 良好（60-89分）：正常
- 较差（30-59分）：需要先补款再发货
- 极差（<30分）：禁止参与团购

---

## 六、特色功能亮点

### 6.1 转单功能（Killer Feature）
**痛点**：
- 用户A参团后因各种原因想退出
- 传统方式：联系团长 → 团长改Excel → 找新买家 → 重新登记
- 团长工作量大，容易出错

**解决方案**：
- 一键生成转单码
- 新买家扫码/输入码即可接单
- 资金直接给原买家（回血）
- 订单自动转移所有权
- 团长零操作，仅收到通知

---

### 6.2 Excel导入订单
**痛点**：
- 团长在微信群手动统计订单
- 复制粘贴到Excel，容易出错
- 逐个通知买家支付定金

**解决方案**：
- 上传现有Excel订单表
- 系统自动解析并生成订单
- 自动发送短信邀请买家绑定订单
- 买家在平台完成后续流程

---

### 6.3 电子合同
**痛点**：
- 传统团购无合同，纠纷难处理
- 买家不信任团长

**解决方案**：
- 支付定金前强制签署电子合同
- 合同包含：商品信息、定金/尾款金额、售后条款
- 合同自动存档，可随时查看
- 提供法律保障

---

### 6.4 自动化通知
**痛点**：
- 团长需要手动在微信群通知进度
- 买家容易错过补款通知

**解决方案**：
- 制作完成：自动发送补款通知（微信服务号 + 短信）
- 进度更新：自动推送给所有参团用户
- 发货：自动发送物流信息
- 催款：第3天、第7天自动提醒

---

## 七、页面导航结构

```
登录/注册
    ↓
═══════════════════════════════════════
主 Tab 页面
═══════════════════════════════════════

[养娃] (普通用户)
    ├── 现货市集
    │   ├── 商品详情 → 签署合同 → 订单详情
    │   └── 商家主页
    └── 开团广场
        ├── 团购详情 → 签署合同 → 订单详情
        └── 团长主页

[工作台] (团长/商家)
    ├── 发起团购
    ├── 订单管理台
    │   ├── 团购详情管理
    │   └── 发货管理
    └── 我的团购列表

[广场]
    ├── 动态流
    ├── 发布动态
    ├── 动态详情
    └── 用户主页

[消息]
    ├── 聊天列表
    └── 通知列表

[我的]
    ├── 我的参团
    ├── 我的关注
    ├── 我的喜欢
    ├── 我的相册
    ├── 我的合同
    ├── 收货地址
    ├── 编辑资料
    ├── 实名认证
    ├── 支付设置
    └── 账号安全

═══════════════════════════════════════
独立页面
═══════════════════════════════════════
├── 接收转单 (扫码/输入转单码)
└── 忘记密码
```

---

## 八、非功能性需求

### 8.1 性能要求
- 页面加载时间 < 2秒
- 图片懒加载
- 接口响应时间 < 500ms
- 支持1000+并发用户

### 8.2 兼容性
- 移动端优先（375px - 428px）
- 支持iOS 13+、Android 8+
- 支持微信浏览器、Safari、Chrome

### 8.3 安全性
- 所有支付信息加密传输（HTTPS）
- 敏感信息脱敏显示（手机号、身份证号）
- 防刷单机制
- 实名认证审核

### 8.4 数据备份
- 订单数据每天备份
- 合同数据永久保存
- 用户数据定期备份

---

## 九、未来规划（Roadmap）

### Phase 2（v2.0）
- [ ] 在线支付对接（支付宝、微信支付）
- [ ] 物流自动查询
- [ ] 售后仲裁系统
- [ ] 团长保证金制度

### Phase 3（v3.0）
- [ ] 直播开箱功能
- [ ] AI虚拟试妆（给娃娃试妆）
- [ ] 娃娃社交匹配（匹配附近玩家）
- [ ] 二手交易市场

### Phase 4（v4.0）
- [ ] 国际化（支持日文、韩文）
- [ ] 跨境团购
- [ ] 虚拟娃社（AI生成娃娃设计）

---

## 十、附录

### 10.1 术语表
- **BJD**：Ball-Jointed Doll，球形关节人偶
- **团长**：团购组织者
- **娃社**：制作BJD的厂家/工作室
- **SKU**：Stock Keeping Unit，库存单位（如"白肌"、"烧肌"）
- **定金**：参团时支付的预付款
- **尾款**：制作完成后补齐的剩余款项
- **工期**：制作娃娃所需的时间（通常3-6个月）
- **私养**：用户自己拥有的娃娃
- **出生证**：娃娃的真品证明卡
- **流团**：因人数不足导致团购取消

### 10.2 参考资料
- 业务逻辑全景图：`业务逻辑全景图.md`
- 商业落地方案：`商业落地方案.md`
- 项目蓝图：`项目蓝图.md`

---

**文档结束**

